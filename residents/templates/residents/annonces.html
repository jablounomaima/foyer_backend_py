<!-- residents/templates/residents/annonces.html -->
{% extends "residents/base.html" %}
{% load static %}

{% block title %}Annonces - Foyer Babel{% endblock %}
{% block page_title %}Annonces{% endblock %}

{% block content %}
                <!-- Topbar -->  
                <!-- Content Row -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card shadow">
                           
                            <div class="card-body">
                                <div class="row" id="announcementsContainer">
                                    <!-- Annonce 1 -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card announcement-card h-100">
                                            <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="announcement-img" alt="Réunion des résidents">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="badge badge-important">Important</span>
                                                    <small class="text-muted">Publié le 10/10/2023</small>
                                                </div>
                                                <h5 class="card-title">Réunion générale des résidents</h5>
                                                <p class="card-text">Une réunion générale est organisée le 15 octobre à 18h dans la salle commune pour discuter des nouvelles règles du foyer.</p>
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <small class="text-muted">Par: Admin Foyer</small>
                                                    <div>
                                                        <button class="btn btn-sm btn-primary">
                                                            <i class="fas fa-eye"></i> 48
                                                        </button>
                                                        <button class="btn btn-sm btn-warning">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Annonce 2 -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card announcement-card h-100">
                                            <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="announcement-img" alt="Nettoyage des espaces">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="badge badge-info">Information</span>
                                                    <small class="text-muted">Publié le 08/10/2023</small>
                                                </div>
                                                <h5 class="card-title">Nettoyage des espaces communs</h5>
                                                <p class="card-text">Un nettoyage général des espaces communs est prévu ce vendredi 13 octobre de 14h à 16h. Merci de libérer les lieux.</p>
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <small class="text-muted">Par: Admin Foyer</small>
                                                    <div>
                                                        <button class="btn btn-sm btn-primary">
                                                            <i class="fas fa-eye"></i> 32
                                                        </button>
                                                        <button class="btn btn-sm btn-warning">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Annonce 3 -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card announcement-card h-100">
                                            <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="announcement-img" alt="Repas communautaire">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="badge badge-warning">Événement</span>
                                                    <small class="text-muted">Publié le 05/10/2023</small>
                                                </div>
                                                <h5 class="card-title">Repas communautaire mensuel</h5>
                                                <p class="card-text">Notre traditionnel repas communautaire aura lieu le 20 octobre à 19h. Inscription avant le 15 octobre.</p>
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <small class="text-muted">Par: Admin Foyer</small>
                                                    <div>
                                                        <button class="btn btn-sm btn-primary">
                                                            <i class="fas fa-eye"></i> 56
                                                        </button>
                                                        <button class="btn btn-sm btn-warning">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Annonce 4 -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card announcement-card h-100">
                                            <img src="https://images.unsplash.com/photo-1556911220-bff31c812dba?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="announcement-img" alt="Maintenance chaudière">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="badge badge-important">Alerte</span>
                                                    <small class="text-muted">Publié le 01/10/2023</small>
                                                </div>
                                                <h5 class="card-title">Maintenance de la chaudière</h5>
                                                <p class="card-text">Intervention technique prévue le 12 octobre de 8h à 12h. Pas d'eau chaude disponible pendant cette période.</p>
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <small class="text-muted">Par: Admin Foyer</small>
                                                    <div>
                                                        <button class="btn btn-sm btn-primary">
                                                            <i class="fas fa-eye"></i> 78
                                                        </button>
                                                        <button class="btn btn-sm btn-warning">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Pagination -->
                                <nav aria-label="Page navigation">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1">Précédent</a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#">Suivant</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ajout Annonce -->
    <div class="modal fade" id="addAnnouncementModal" tabindex="-1" aria-labelledby="addAnnouncementModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addAnnouncementModalLabel">Créer une nouvelle annonce</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addAnnouncementForm">
                        <div class="mb-3">
                            <label for="announcementTitle" class="form-label">Titre de l'annonce</label>
                            <input type="text" class="form-control" id="announcementTitle" placeholder="Ex: Réunion générale des résidents" required>
                        </div>
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label for="announcementType" class="form-label">Type d'annonce</label>
                                <select class="form-select" id="announcementType" required>
                                    <option value="" selected disabled>Sélectionner un type</option>
                                    <option value="important">Important</option>
                                    <option value="info">Information</option>
                                    <option value="event">Événement</option>
                                    <option value="alert">Alerte</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="announcementDate" class="form-label">Date de publication</label>
                                <input type="datetime-local" class="form-control" id="announcementDate" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="announcementImage" class="form-label">Image illustrative (optionnelle)</label>
                            <input class="form-control" type="file" id="announcementImage" accept="image/*">
                        </div>
                        <div class="mb-3">
                            <label for="announcementContent" class="form-label">Contenu de l'annonce</label>
                            <textarea id="announcementContent" class="form-control"></textarea>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="sendNotification" checked>
                            <label class="form-check-label" for="sendNotification">Envoyer une notification à tous les résidents</label>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="pinAnnouncement">
                            <label class="form-check-label" for="pinAnnouncement">Épingler cette annonce en haut de la liste</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary">Publier l'annonce</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <!-- Summernote JS -->
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/lang/summernote-fr-FR.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // Initialisation de l'éditeur de texte
            $('#announcementContent').summernote({
                height: 200,
                lang: 'fr-FR',
                toolbar: [
                    ['style', ['bold', 'italic', 'underline', 'clear']],
                    ['font', ['strikethrough']],
                    ['para', ['ul', 'ol', 'paragraph']],
                    ['insert', ['link', 'picture', 'video']],
                    ['view', ['fullscreen', 'codeview', 'help']]
                ]
            });
            
            // Définir la date et heure actuelles par défaut
            const now = new Date();
            const formattedDateTime = now.toISOString().slice(0, 16);
            document.getElementById('announcementDate').value = formattedDateTime;
            
            // Prévisualisation de l'image sélectionnée
            $('#announcementImage').change(function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Vous pourriez afficher un aperçu ici si nécessaire
                        console.log("Image sélectionnée:", e.target.result);
                    }
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>
</div>
{% endblock %}